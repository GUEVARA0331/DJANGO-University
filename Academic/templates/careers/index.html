{% extends "layout.html" %} 

{% block title %} Universidad | Carreras {% endblock %} 

{% block header-page %} 
    <div class="col-sm-6">
        <h1 class="m-0">Sección de Carreras Profesionales</h1>
    </div><!-- /.col -->
    <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="{% url 'careers' %}">Carreras</a></li>
        <li class="breadcrumb-item active">Lista</li>
        </ol>
    </div><!-- /.col -->
{% endblock %} 

{% block content %}  
    <div class="card card-primary card-outline col-8 mx-auto">
        <div class="card-header">
          <div class="row">
            <div class="col-auto me-auto">
              <h3 class="m-0">Listado de Carreras Registradas</h3>
            </div>
            <div class="col-auto">
              <a href="{% url 'addCareer' %}" class="btn btn-primary">Agregar Nueva Carrera</a>
            </div>
          </div>    
        </div>
        <div class="card-body">
            <div class="table table-responsive rounded-3">
                <table class="table">
                    <thead class="table-dark">
                      <tr>
                        <th>#</th>
                        <th>Código</th>
                        <th>Nombre</th>
                        <th>Duración</th>
                        <th class="text-center">Acciones</th>
                      </tr>
                    </thead>
                    <tbody">
                      {% for career in careers %}
                        <tr>                          
                          <th>{{ forloop.counter }}</th>
                          <td>{{ career.code }}</td>
                          <td>{{ career.name }}</td>
                          <td>{{ career.duration }} {% if career.duration == 1  %} año {% else %} años {% endif %}
                            </td>
                          <td class="text-center">
                            <a href="{% url 'editCareer' career.id %}" type="button" class="btn btn-outline-warning btn-sm mb-2"><i class="fas fa-edit"></i>Editar</a><br>
                            <a href="{% url 'deleteCareer' career.id %}" type="button" class="btn btn-outline-danger btn-sm" id="btnDeleteCareer"><i class="fas fa-trash-alt"></i>Eliminar</a>
                          </td>
                        </tr>
                      {% endfor %}
                    </tbody>
                  </table>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
  <script>
    const btnsDelete = document.querySelectorAll("#btnDeleteCareer")
    btnsDelete.forEach((btn) => {
      btn.addEventListener("click", function (e) {
        e.preventDefault(); 
        Swal.fire({
          title: "¿Confirma la eliminación de la Carrera?",
          text: "Esta acción podría eliminar el registro de todos los estudiantes que hacen parte de esta Carrera",  
          showCancelButton: true,
          cancelButtonText: "Cancelar", 
          confirmButtonText: "Eliminar", 
          confirmButtonColor: "#d33",
          backdrop: true,
          showLoaderOnConfirm: true, 
          preConfirm: () => {
            location.href = e.target.href; 
          },
          allowOutsideClick: () => false, 
          allowEscapeKey: () => false, 
        });  
      });
    });
  </script>
{% endblock %}